from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.common.keys import Keys
from selenium.webdriver.chrome.service import Service
from selenium.webdriver.chrome.options import Options
import time

# Set up Chrome options
chrome_options = Options()
download_directory = "/path/to/your/download/folder"  # Change this to your desired download path
chrome_options.add_experimental_option("prefs", {
    "download.default_directory": download_directory,
    "download.prompt_for_download": False,
    "download.directory_upgrade": True,
    "safebrowsing.enabled": True
})

# Set up WebDriver
service = Service("/path/to/chromedriver")  # Update this path
driver = webdriver.Chrome(service=service, options=chrome_options)

# Open Jira webpage
driver.get("https://jira.cc.bmwgroup.net/secure/StructureBoard.jspa?s=8870#")  # Update the correct URL
time.sleep(5)  # Wait for the page to load

# Click on "Export" button
export_button = driver.find_element(By.XPATH, "//button[contains(text(), 'Export')]")
export_button.click()
time.sleep(2)

# Click on "Export to Excel"
export_excel_button = driver.find_element(By.XPATH, "//span[contains(text(), 'Export to Excel')]")
export_excel_button.click()

# Wait for the file to download
time.sleep(10)  # Adjust time based on network speed

# Close the browser
driver.quit()


Steps to Use:
Update the download_directory with your preferred download location.
Replace /path/to/chromedriver with the actual path to your ChromeDriver.
Ensure you are logged in to Jira or handle authentication in the script.
Run the script and check the download folder.
